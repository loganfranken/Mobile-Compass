window.onload=function(){var a=document.getElementById("compass");paper.setup(a);var b=new Compass();b.draw(paper);paper.view.draw();window.addEventListener("deviceorientation",function(c){if(c.alpha){var d=360-c.alpha;document.getElementById("status").innerHTML=Math.floor(d)+"&deg;";b.setNeedleRotation(d);paper.view.draw()}})};function Compass(a){this._currDegrees=null;this._center=null;this._topNeedle=null;this._bottomNeedle=null}Compass.prototype.setNeedleRotation=function(b){var c=(b<0)?0:(b>360)?360:b;var a=c-this._currDegrees;this._topNeedle.rotate(a,this._center);this._bottomNeedle.rotate(a,this._center);this._currDegrees=c};Compass.prototype.draw=function(b){var u=b.view.viewSize.width;var s=b.view.viewSize.height;var q=(u>s)?s:u;var c=q/2;var t=c*0.8;var k=t*0.92;var x=this._center=b.view.center;var o=this._center.x;var n=this._center.y;var B=new b.Path.Circle(x,t);var r=B.bounds.y;var p=r+B.bounds.height;B.strokeWidth=2;B.strokeColor="#ABABAB";B.fillColor=new b.GradientColor(new b.Gradient(["#D6D6D6","#777"]),new b.Point(o,r),new b.Point(o,p));var w=new b.Path.Circle(x,k);var a=w.position;var z=w.bounds.y+w.bounds.height;w.strokeWidth=2;w.strokeColor="#999";w.fillColor=new b.GradientColor(new b.Gradient(["#FFF","#E5FAFC"],"radial"),a,z);var m=w.bounds.y;var v=w.bounds.width;var e=(v*0.1)/2;var h=v*0.04;var g=o;var d=m+h;var l=g+e;var j=n;var A=g;var y=m+v-h;var i=o-e;var f=n;this._topNeedle=new b.Path([new b.Point(g,d),new b.Point(l,j),new b.Point(i,f)]);this._topNeedle.closed=true;this._topNeedle.fillColor=new b.GradientColor(new b.Gradient([["#C00",0.5],["#ED0000",0.5]]),new b.Point(i,n),new b.Point(l,n));this._bottomNeedle=new b.Path([new b.Point(l,j),new b.Point(A,y),new b.Point(i,f)]);this._bottomNeedle.closed=true;this._bottomNeedle.fillColor=new b.GradientColor(new b.Gradient([["#CCC",0.5],["#E6E6E6",0.5]]),new b.Point(i,n),new b.Point(l,n));this._currDegrees=0};var Geometry={};Geometry.normalizeDegrees=function(b){var a=(b%360);if(a<0){a=(360+a)}return a};